<div class="vehicle-list-wrapper">
  <h2>Lista de VeÃ­culos</h2>

  <div class="search-group">
    <div class="search-wrapper">
      <span class="search-icon">ğŸ”</span>
      <input
        type="text"
        placeholder="Digite para buscar veÃ­culo por placa, modelo, etc..."
        [(ngModel)]="search"
        (ngModelChange)="onSearchChange()"
      />
    </div>
    <button
      class="add-btn"
      title="Adicionar veÃ­culo"
      (click)="openAddModal()"
      style="
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        font-size: 14px;
        height: 40px;
      "
    >
      <span class="material-icons" style="color: white; font-size: 24px"
        >add</span
      >
      Adicionar
    </button>
  </div>

  <div *ngIf="successMessage" class="alert alert-success">
    {{ successMessage }}
    <button class="close-btn" (click)="closeSuccess()">âœ…</button>
  </div>
  <div *ngIf="errorMessage" class="error-notification">
    <span>{{ errorMessage }}</span>
    <button class="close-btn" (click)="closeError()">âŒ</button>
  </div>
  <div *ngIf="isLoading" class="loader">Carregando veÃ­culos...</div>

  <div class="table-responsive" *ngIf="!isLoading && vehicles.length">
    <table class="vehicle-table">
      <thead>
        <tr>
          <th>Placa</th>
          <th>Chassi</th>
          <th>Renavam</th>
          <th>Modelo</th>
          <th>Marca</th>
          <th>Ano</th>
          <th>AÃ§Ãµes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let v of vehicles">
          <td>{{ v.placa }}</td>
          <td>{{ v.chassi }}</td>
          <td>{{ v.renavam }}</td>
          <td>{{ v.modelo }}</td>
          <td>{{ v.marca }}</td>
          <td>{{ v.ano }}</td>
          <td>
            <button
              class="edit-btn"
              title="Editar veÃ­culo"
              (click)="openEditModal(v)"
            >
              âœï¸
            </button>

            <button
              class="delete-btn"
              title="Excluir veÃ­culo"
              (click)="confirmDelete(v)"
            >
              ğŸ—‘ï¸
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="vehicleToDelete" class="confirm-box">
    <p>Tem certeza que deseja deletar esse veÃ­culo?</p>
    <div class="btn-group">
      <button class="ok-btn" (click)="deleteVehicle()">âœ…</button>
      <button class="cancel-btn" (click)="cancelDelete()">âŒ</button>
    </div>
  </div>

  <div *ngIf="vehicleToAdd" class="edit-modal">
    <h3>Adicionar VeÃ­culo</h3>
    <form (ngSubmit)="addVehicle()" class="edit-form">
      <input
        type="text"
        [(ngModel)]="vehicleToAdd.placa"
        name="placa"
        placeholder="Placa"
        required
      />
      <input
        type="text"
        [(ngModel)]="vehicleToAdd.chassi"
        name="chassi"
        placeholder="Chassi"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToAdd.renavam"
        name="renavam"
        placeholder="Renavam"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToAdd.modelo"
        name="modelo"
        placeholder="Modelo"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToAdd.marca"
        name="marca"
        placeholder="Marca"
      />
      <input
        type="number"
        [(ngModel)]="vehicleToAdd.ano"
        name="ano"
        placeholder="Ano"
      />

      <div class="btn-group">
        <button type="submit" class="ok-btn">ğŸ’¾ Salvar</button>
        <button type="button" class="cancel-btn" (click)="cancelAdd()">
          âŒ Cancelar
        </button>
      </div>
    </form>
  </div>

  <div *ngIf="!isLoading && vehicles.length === 0" class="no-data">
    Nenhum veÃ­culo encontrado.
  </div>

  <div *ngIf="vehicleToEdit" class="edit-modal">
    <h3>Editar VeÃ­culo</h3>
    <form (ngSubmit)="updateVehicle()" class="edit-form">
      <input
        type="text"
        [(ngModel)]="vehicleToEdit.placa"
        name="placa"
        placeholder="Placa"
        required
      />
      <input
        type="text"
        [(ngModel)]="vehicleToEdit.chassi"
        name="chassi"
        placeholder="Chassi"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToEdit.renavam"
        name="renavam"
        placeholder="Renavam"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToEdit.modelo"
        name="modelo"
        placeholder="Modelo"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToEdit.marca"
        name="marca"
        placeholder="Marca"
      />
      <input
        type="text"
        [(ngModel)]="vehicleToEdit.ano"
        name="ano"
        placeholder="Ano"
      />

      <div class="btn-group">
        <button type="submit" class="ok-btn">ğŸ’¾ Salvar</button>
        <button type="button" class="cancel-btn" (click)="cancelEdit()">
          âŒ Cancelar
        </button>
      </div>
    </form>
  </div>

  <div class="pagination" *ngIf="!isLoading && lastPage > 1">
    <button (click)="prevPage()" [disabled]="page === 1">â† Anterior</button>
    <span>
      PÃ¡gina
      <input
        type="number"
        [(ngModel)]="page"
        [min]="1"
        [max]="lastPage"
        (ngModelChange)="goToPage(page)"
        class="page-input"
      />
      de {{ lastPage }}
    </span>
    <button (click)="nextPage()" [disabled]="page === lastPage">
      PrÃ³xima â†’
    </button>
  </div>
</div>
